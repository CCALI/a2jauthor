<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
	CALI Author 5 / A2J Author 5 (CAJA)
	All Contents Copyright The Center for Computer-Assisted Legal Instruction
-->
<HTML xmlns="http://www.w3.org/1999/xhtml">
<link title="style" href="../themes/a2j/jquery-ui.css"  rel="stylesheet" type="text/css"/>


<link  href="../jQuery/jquery.ui.custom.css" rel="stylesheet" type="text/css" />
<script src="../jQuery/jquery.1.10.2.min.js" type="text/javascript"></script>
<script src="../jQuery/jquery.ui.1.10.3.min.js" type="text/javascript"></script>
<script src="../jQuery/jquery.ui.custom.min.js" type="text/javascript" ></script>
<link  href="../jQuery/jquery.fileupload-ui.css" rel="stylesheet" type="text/css" />


<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
<script xsrc="../jQuery/load-image.min.js"></script>
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script xsrc="../jQuery/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<script src="../jQuery/jquery.fileupload.js"></script>
<!-- The File Upload processing plugin -->
<script src="../jQuery/jquery.fileupload-process.js"></script>
<!-- The File Upload image preview & resize plugin -->
<script xsrc="../jQuery/jquery.fileupload-image.js"></script>
<!-- The File Upload audio preview plugin -->
<script xsrc="../jQuery/jquery.fileupload-audio.js"></script>
<!-- The File Upload validation plugin -->
<script src="../jQuery/jquery.fileupload-validate.js"></script>
<!-- The File Upload user interface plugin -->
<script xsrc="../jQuery/jquery.fileupload-ui.js"></script>
<!-- The File Upload jQuery UI plugin -->
<script xsrc="../jQuery/jquery.fileupload-jquery-ui.js"></script>



<style type="text/css"> 
</style>

 
<script type='text/javascript'> 
// 04/2013 Test file browsing feature

var sysFiles = {};

function updateSysFiles( ) {
	 // Load existing files:
	 $.ajax({
		  // Uncomment the following to send cross-domain cookies:
		  //xhrFields: {withCredentials: true},
		  url: $('#fileupload').fileupload('option', 'url'),
		  dataType: 'json',
		  context: $('#fileupload')[0]
	 }).always(function () {
		  $(this).removeClass('fileupload-processing');
	 }).done(function (result) {
		  sysFiles = result.files;
		  $('#sysFiles').empty();
			$.each(sysFiles, function (index, file) {
				 $('<p/>').text(file.name).appendTo('#sysFiles');
			});	
		 
		 
	 });

}
	 
$(document).ready(function(){ 
	 $('input[type=button]').addClass('ui-button ui-widget ui-state-default ui-corner-all');
	  
	 $('#fileupload').addClass('fileupload-processing');
    $('#fileupload').fileupload({
        url: '../jQuery/UploadHandler-index.php',
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result.files, function (index, file) {
                $('<p/>').text(file.name).appendTo('#files');
            });
        },
        progressall: function (e, data) {
            var progress = parseInt(data.loaded / data.total * 100, 10);
            $('#progress .bar').css(
                'width',
                progress + '%'
            );
        }
    });
	 
	  updateSysFiles();
	 
	 
	  // Load existing files:
	  if (0)
	 $.ajax({
		  // Uncomment the following to send cross-domain cookies:
		  //xhrFields: {withCredentials: true},
		  url: $('#fileupload').fileupload('option', 'url'),
		  dataType: 'json',
		  context: $('#fileupload')[0]
	 }).always(function () {
		  $(this).removeClass('fileupload-processing');
	 }).done(function (result) {
		  alert(result.files);
		  $(this).fileupload('option', 'done')
				.call(this, null, {result: result});
	 });

	 
});

function browseXML(field)
{
	 browseServer(field,'Lists');
}
function browseImage(field)
{
	 browseServer(field,'Images');
}

// This is a sample function which is called when a file is selected in CKFinder.
function SetFileField( fileUrl )
{
	 if (this.data.kind==='Images') {
		  
		  browseFileSet(this.data.field,fileUrl);
	 }
	 else
	 {
		  $('#'+this.data.field).val(fileUrl);
	 }
}
/*
 *
function browseServer(field,kind)
{
	 // You can use the "CKFinder" class to render CKFinder in a page:
	 var finder = new CKFinder( );
	 //finder.basePath = '../';	// The path for the installation of CKFinder (default = "/ckfinder/").
	 finder.selectActionFunction = SetFileField;
	 //CKFinder.config.startupPath ="Guides:/A2J_MobileOnline/";// "Images:/Images/";
	 CKFinder.config.startupPath =kind+":/A2J_MobileOnline/";
	 var api = finder.popup();
	 api.data={field:field,kind:kind};
	 api.openFolder('Guides','/A2J_MobileOnline/');
	 
	 // It can also be done in a single line, calling the "static"
	 // popup( basePath, width, height, selectFunction ) function:
	 // CKFinder.popup( '../', null, null, SetFileField ) ;
	 //
	 // The "popup" function can also accept an object as the only argument.
	 // CKFinder.popup( { basePath : '../', selectActionFunction : SetFileField } ) ;
}
function browseImageSet(field,src) {
//	 $('#filePath2').parent().next().find('img').attr('src','http://localhost/js/editors/ckfinder/core/connector/php/connector.php?command=Thumbnail&type=Guides&currentFolder=/A2J_MobileOnline/&langCode=en&FileName=smallestate_screenshot.jpg&')
	 //$('#filePath2').val('A2J_MobileOnline/smallestate_screenshot.jpg');
	 src = src.replace(/^.*[\\\/]/, '');
	 $('#'+field).val(src).parent().next().find('img').attr('src',
		  'http://localhost/js/editors/ckfinder/core/connector/php/connector.php?command=Thumbnail&type=Guides&currentFolder=/A2J_MobileOnline/&langCode=en&FileName='+src+'&');
}
*/
</script>
<title>File Browser</title><BODY>




  
<table>
  <h1>Pick files</h1>
<tr valign=top><td>Choose an interview:</td><td><input id="filePath0" type="text" size="40" /> <input type="button" value="Find XML"    onclick="browseXML('filePath0');" /></td><td></td></tr>
<tr valign=top><td>Pick List</td><td><input id="filePath1" type="text" size="40" /> <input type="button" value="Browse XML"    onclick="browseXML('filePath1');" /></td><td></td></tr>
<tr valign=top><td>Help Image: </td><td><input id="filePath2" type="text" size="40" /> <input type="button" value="Browse Image" onclick="browseImage('filePath2');" /></td><td> <img src="" width=100 height=100/> </td></tr>
<tr valign=top><td>Logo Image: </td><td><input id="filePath3" type="text" size="40" /> <input type="button" value="Browse Image" onclick="browseImage('filePath3');" /> </td><td><img src=""/></td></tr>
</table> 
  <h1>All files</h1>
    <div id="sysFiles" class="files"></div>

  <h1>Upload io</h1>


<div class="container">
    <!-- The fileinput-button span is used to style the file input field as button -->
    <span class="btn btn-success fileinput-button">
        <i class="icon-plus icon-white"></i>
        <span>Select files...</span>
        <!-- The file input field used as target for the file upload widget -->
        <input id="fileupload" type="file" name="files[]" multiple />
    </span>
    <br/>
    <br/>
    <!-- The global progress bar -->
    <div id="progress" class="progress progress-success progress-striped">
        <div class="bar"></div>
    </div>
    <!-- The container for the uploaded files -->
    <div id="files" class="files"></div>
</div> 
</BODY>
</HTML>
